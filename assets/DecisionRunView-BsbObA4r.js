import{y as v,r as g,d as h,j as y,o as w,a as d,e,q as l,t as u,p as n,F as _,g as P,w as R,v as k,h as A,i as c}from"./index-D1xg2Y6x.js";const x={async getRules(o){return new Promise(m=>{setTimeout(()=>{m({score:98.5,rules:[{id:"r1",code:"SPLIT_PO_CHECK",name:"Split PO Detection",description:"Checks for multiple POs to same vendor within 48h",status:"WARNING",message:"Found 2 POs (Total: 3.4M THB) within 24 hours."},{id:"r2",code:"BUDGET_LIMIT",name:"Budget Threshold",description:"Verify department budget availability",status:"PASS",message:"Within Q1-2026 Marketing Budget"},{id:"r3",code:"VENDOR_SLA",name:"Vendor Reliability Score",description:"Checks vendor historical performance",status:"PASS",message:"Vendor Score: A+ (99% On-time)"}]})},800)})},async submitDecision(o,m,s){return console.log(`[API] Submitting decision for ${o}: ${m} (Reason: ${s})`),new Promise(a=>{setTimeout(()=>{a(!0)},1200)})}},S=v("decision",()=>{const o=g({caseId:"",recommendation:"APPROVE",confidenceScore:0,rules:[],isProcessing:!1,userDecision:void 0});async function m(a){o.value.isProcessing=!0,o.value.caseId=a;try{const r=await x.getRules(a);o.value.rules=r.rules,o.value.confidenceScore=r.score}catch(r){console.error(r),o.value.error="Failed to load rules"}finally{o.value.isProcessing=!1}}async function s(a,r){if(!r&&a==="REJECT"){alert("Please provide a reason for rejection.");return}o.value.isProcessing=!0;try{await x.submitDecision(o.value.caseId,a,r),o.value.userDecision=a==="APPROVE"?"APPROVED":"REJECTED"}catch{alert("Failed to submit decision")}finally{o.value.isProcessing=!1}}return{state:o,loadContext:m,submit:s}}),D={class:"grid grid-cols-1 lg:grid-cols-12 gap-6 pb-20"},E={class:"lg:col-span-8 space-y-6"},I={class:"bg-white rounded-xl border border-slate-200 p-6 shadow-sm relative overflow-hidden group transition-all duration-300 hover:shadow-md animate-enter"},C={class:"relative z-10"},T={class:"flex items-baseline gap-4 mb-2"},V={class:"text-lg font-medium text-slate-500"},O={class:"text-slate-900 font-bold"},j={class:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden animate-enter",style:{"animation-delay":"100ms"}},N={class:"p-4 border-b border-slate-100 bg-slate-50/50 flex justify-between items-center"},F={class:"text-xs text-slate-400 font-mono"},B={key:0,class:"p-8 space-y-4"},L={key:1,class:"divide-y divide-slate-100"},M={class:"flex items-start gap-4"},$={class:"shrink-0 mt-1"},q={class:"material-icons-outlined text-sm"},z={class:"flex-1"},G={class:"flex justify-between items-start mb-1"},W={class:"text-sm font-bold text-slate-900"},H={class:"font-mono text-[10px] text-slate-400 uppercase"},J={class:"text-sm text-slate-600 mb-2"},U={class:"bg-slate-50 p-2 rounded border border-slate-100 text-xs font-mono text-slate-700 flex items-start gap-2"},Y={class:"lg:col-span-4 space-y-6 animate-enter",style:{"animation-delay":"200ms"}},K={class:"bg-white rounded-xl border border-slate-200 p-6 shadow-sm sticky top-6"},Q={key:0,class:"text-center py-8 animate-enter"},X={class:"text-sm text-slate-500"},Z={class:"font-bold"},ee={key:1},te={class:"mb-4"},se={class:"space-y-3"},oe=["disabled"],ae={key:0,class:"material-icons-outlined animate-spin text-sm"},ne={key:1,class:"material-icons-outlined text-sm group-hover:scale-110 transition"},ie=["disabled"],re=h({__name:"DecisionRunView",setup(o){const m=y(),s=S(),a=g(""),r=m.params.caseId;w(()=>{s.loadContext(r)});const b=p=>{switch(p){case"PASS":return"text-emerald-600 bg-emerald-50 border-emerald-100";case"FAIL":return"text-red-600 bg-red-50 border-red-100";case"WARNING":return"text-amber-600 bg-amber-50 border-amber-100";default:return"text-slate-500 bg-slate-50"}},f=p=>{switch(p){case"PASS":return"check_circle";case"FAIL":return"cancel";case"WARNING":return"warning";default:return"help"}};return(p,t)=>(c(),d("div",D,[e("div",E,[e("div",I,[t[7]||(t[7]=e("div",{class:"absolute left-0 top-0 bottom-0 w-1.5 bg-emerald-500 transition-all duration-300 group-hover:w-2"},null,-1)),t[8]||(t[8]=e("div",{class:"absolute inset-0 bg-gradient-to-r from-transparent via-emerald-50/30 to-transparent -translate-x-full group-hover:animate-shimmer z-0 pointer-events-none"},null,-1)),e("div",C,[t[5]||(t[5]=e("div",{class:"flex justify-between items-start mb-4"},[e("h2",{class:"text-lg font-bold flex items-center gap-2 text-slate-800"},[e("span",{class:"material-icons-outlined text-emerald-600 transition-transform duration-500 group-hover:rotate-12"},"psychology"),l(" AI Analysis Result ")]),e("span",{class:"px-3 py-1 bg-slate-100 text-slate-600 rounded-full text-xs font-mono border border-slate-200"}," Model: v3.4.2 (Llama-3-Financed) ")],-1)),e("div",T,[t[4]||(t[4]=e("div",{class:"text-5xl font-extrabold text-emerald-600 tracking-tight"},"APPROVE",-1)),e("div",V,[t[3]||(t[3]=l(" Confidence: ",-1)),e("span",O,u(n(s).state.confidenceScore)+"%",1)])]),t[6]||(t[6]=e("p",{class:"text-sm text-slate-500 mt-2"},[l(" Based on "),e("strong",null,"Policy Procurement-001"),l(" and historical vendor data. No critical compliance blockers found, although one warning requires attention. ")],-1))])]),e("div",j,[e("div",N,[t[9]||(t[9]=e("h3",{class:"font-bold text-slate-800 flex items-center gap-2"},[e("span",{class:"material-icons-outlined text-slate-400"},"format_list_bulleted"),l(" Logic Execution Trace ")],-1)),e("span",F,"Trace ID: "+u(n(r).split("-")[3]||"88291"),1)]),n(s).state.isProcessing&&n(s).state.rules.length===0?(c(),d("div",B,[...t[10]||(t[10]=[e("div",{class:"h-12 bg-slate-50 rounded animate-pulse"},null,-1),e("div",{class:"h-12 bg-slate-50 rounded animate-pulse"},null,-1),e("div",{class:"h-12 bg-slate-50 rounded animate-pulse"},null,-1)])])):(c(),d("div",L,[(c(!0),d(_,null,P(n(s).state.rules,i=>(c(),d("div",{key:i.id,class:"p-5 hover:bg-slate-50/50 transition-colors"},[e("div",M,[e("div",$,[e("div",{class:A(`w-8 h-8 rounded-full flex items-center justify-center border ${b(i.status)}`)},[e("span",q,u(f(i.status)),1)],2)]),e("div",z,[e("div",G,[e("h4",W,u(i.name),1),e("span",H,u(i.code),1)]),e("p",J,u(i.description),1),e("div",U,[t[11]||(t[11]=e("span",{class:"material-icons-outlined text-[14px] text-slate-400 mt-[1px]"},"terminal",-1)),l(" "+u(i.message),1)])])])]))),128))]))])]),e("div",Y,[e("div",K,[n(s).state.userDecision?(c(),d("div",Q,[t[14]||(t[14]=e("div",{class:"w-16 h-16 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center mx-auto mb-4"},[e("span",{class:"material-icons-outlined text-3xl"},"check")],-1)),t[15]||(t[15]=e("h3",{class:"text-lg font-bold text-slate-900 mb-1"},"Decision Recorded",-1)),e("p",X,[t[12]||(t[12]=l(" You have ",-1)),e("span",Z,u(n(s).state.userDecision),1),t[13]||(t[13]=l(" this case. ",-1))]),t[16]||(t[16]=e("div",{class:"mt-6 p-3 bg-slate-50 rounded text-xs text-slate-400 font-mono"}," Audit Hash: 0x7f...3a2b ",-1))])):(c(),d("div",ee,[t[20]||(t[20]=e("h3",{class:"font-bold text-slate-800 mb-4 flex items-center gap-2"},[e("span",{class:"material-icons-outlined text-slate-400"},"gavel"),l(" Final Decision ")],-1)),e("div",te,[t[17]||(t[17]=e("label",{class:"block text-xs font-bold text-slate-500 uppercase mb-2"},"Decision Reason / Note",-1)),R(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=i=>a.value=i),class:"w-full p-3 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-primary/20 focus:border-primary focus:outline-none transition resize-none placeholder-slate-300",rows:"5",placeholder:"Required for Rejection. Optional for Approval."},null,512),[[k,a.value]])]),e("div",se,[e("button",{onClick:t[1]||(t[1]=i=>n(s).submit("APPROVE",a.value)),disabled:n(s).state.isProcessing,class:"w-full py-3 bg-emerald-600 text-white rounded-lg font-bold shadow-md shadow-emerald-900/10 transition-all duration-200 hover:bg-emerald-500 hover:shadow-lg hover:-translate-y-0.5 active:translate-y-0 active:bg-emerald-700 disabled:opacity-70 disabled:cursor-not-allowed disabled:transform-none flex justify-center items-center gap-2 group"},[n(s).state.isProcessing?(c(),d("span",ae,"refresh")):(c(),d("span",ne,"check_circle")),t[18]||(t[18]=l(" Approve Case ",-1))],8,oe),e("button",{onClick:t[2]||(t[2]=i=>n(s).submit("REJECT",a.value)),disabled:n(s).state.isProcessing,class:"w-full py-3 bg-white border border-slate-200 text-slate-700 rounded-lg font-bold transition-all duration-200 hover:bg-red-50 hover:text-red-700 hover:border-red-200 hover:-translate-y-0.5 active:translate-y-0 disabled:opacity-70 disabled:cursor-not-allowed disabled:transform-none flex justify-center items-center gap-2"},[...t[19]||(t[19]=[e("span",{class:"material-icons-outlined text-sm"},"block",-1),l(" Reject & Request Revision ",-1)])],8,ie)]),t[21]||(t[21]=e("p",{class:"text-[10px] text-slate-400 text-center mt-4"}," Your action will be cryptographically signed and logged. ",-1))]))])])]))}});export{re as default};
